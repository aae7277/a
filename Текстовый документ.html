<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ò–ò-–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ v11 [CLASSIFIED]</title>
    <style>
        :root {
            --bg-color: #121212;
            --surface-color: #1e1e1e;
            --primary-color: #00aaff;
            --text-color: #e0e0e0;
            --secondary-text-color: #a0a0a0;
            --border-color: #333333;
            --secret-color: #be29cc;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        html, body {
            height: 100%;
            font-family: 'Consolas', 'Menlo', 'Courier New', monospace;
            background-color: var(--bg-color);
            color: var(--text-color);
            overflow: hidden;
        }
        .app-container {
            display: flex; flex-direction: column;
            height: 100vh; max-width: 800px; margin: 0 auto; padding: 20px;
        }
        .header {
            text-align: center; padding-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
        }
        .header h1 { color: var(--primary-color); font-size: 2em; text-shadow: 0 0 8px rgba(0, 170, 255, 0.7); }
        .header p { color: var(--secondary-text-color); font-size: 0.9em; }
        #secret-burger { cursor: pointer; user-select: none; }

        .chat-window {
            flex-grow: 1; overflow-y: auto; padding: 20px 10px;
            display: flex; flex-direction: column; gap: 15px;
            scrollbar-width: thin; scrollbar-color: var(--primary-color) var(--surface-color);
        }
        .chat-window::-webkit-scrollbar { width: 8px; }
        .chat-window::-webkit-scrollbar-track { background: var(--surface-color); }
        .chat-window::-webkit-scrollbar-thumb { background-color: var(--primary-color); border-radius: 4px; }

        .message {
            max-width: 85%; padding: 10px 15px; border-radius: 12px;
            line-height: 1.5; word-wrap: break-word;
            animation: fadeIn 0.3s ease-in-out;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .ai-message { background-color: var(--surface-color); align-self: flex-start; border-top-left-radius: 0; border: 1px solid var(--border-color); }
        .ai-message::before { content: "–ò–ò: "; font-weight: bold; color: var(--primary-color); }
        .user-message { background-color: var(--primary-color); color: var(--bg-color); align-self: flex-end; border-top-right-radius: 0; font-weight: bold; }
        .user-message::before { content: "–í—ã: "; }
        .story-message {
            background-color: rgba(190, 41, 204, 0.1);
            border: 1px solid var(--secret-color);
            color: var(--secret-color);
            align-self: center;
            text-align: left;
            font-style: italic;
            max-width: 90%;
        }
        .story-message::before { content: "[–ò–ó–í–õ–ï–ß–ï–ù–ù–´–ô –õ–û–ì #772] "; font-weight: bold; }

        .input-area { display: flex; padding-top: 20px; border-top: 1px solid var(--border-color); gap: 10px; }
        #user-input {
            flex-grow: 1; background-color: var(--surface-color); border: 1px solid var(--border-color);
            border-radius: 8px; padding: 12px; color: var(--text-color); font-size: 1em; outline: none;
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        #user-input:focus { border-color: var(--primary-color); box-shadow: 0 0 8px rgba(0, 170, 255, 0.5); }
        #send-btn { background-color: var(--primary-color); border: none; border-radius: 8px; color: #fff; padding: 0 25px; font-size: 1em; cursor: pointer; transition: all 0.2s; }
        #send-btn:hover { background-color: #0088cc; }
    </style>
</head>
<body>
    <div class="app-container">
        <header class="header">
            <h1>–ò–ò-–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç</h1>
            <p>–í–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –æ–±—â–µ–Ω–∏—è —Å –ò–ò. <span id="secret-burger" title="–ß—Ç–æ —ç—Ç–æ?">üçî</span></p>
        </header>
        <div class="chat-window" id="chat-window"></div>
        <div class="input-area">
            <input type="text" id="user-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –∑–∞–ø—Ä–æ—Å...">
            <button id="send-btn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        </div>
    </div>

    <script>
    // --- –ù–ê–°–¢–†–û–ô–ö–ê ---
    // –í—Å—Ç–∞–≤—å—Ç–µ –≤–∞—à –∫–ª—é—á API –æ—Ç OpenAI –≤ –∫–∞–≤—ã—á–∫–∏.
    // –ï—Å–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å, –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –æ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º.
    const OPENAI_API_KEY = "AIzaSyAETqagxax6j0TZ2md_rn-1uIbW1S-X_wM";
    
    // --- DOM –≠–õ–ï–ú–ï–ù–¢–´ ---
    const chatWindow = document.getElementById('chat-window');
    const userInput = document.getElementById('user-input');
    const sendBtn = document.getElementById('send-btn');
    const secretBurger = document.getElementById('secret-burger');

    // --- –ü–ï–†–ï–ú–ï–ù–ù–´–ï ---
    let conversationHistory = [];
    let storyShown = false; // –§–ª–∞–≥, —á—Ç–æ–±—ã –∏—Å—Ç–æ—Ä–∏—è –Ω–µ –ø–æ–≤—Ç–æ—Ä—è–ª–∞—Å—å

    // --- –ë–ê–ó–ê –ó–ù–ê–ù–ò–ô (–î–õ–Ø –û–§–õ–ê–ô–ù –†–ï–ñ–ò–ú–ê) ---
    const offlineResponses = {
        '–ø—Ä–∏–≤–µ—Ç': '–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –Ø –≤ –æ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º–µ. –ß—Ç–æ–±—ã —è –∑–∞—Ä–∞–±–æ—Ç–∞–ª, –≤—Å—Ç–∞–≤—å—Ç–µ API –∫–ª—é—á –≤ –∫–æ–¥ —ç—Ç–æ–≥–æ HTML-—Ñ–∞–π–ª–∞.',
        '–∫–∞–∫ –¥–µ–ª–∞?': '–†–∞–±–æ—Ç–∞—é –≤ –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–º —Ä–µ–∂–∏–º–µ. –í—Å–µ —Å–∏—Å—Ç–µ–º—ã –≤ –Ω–æ—Ä–º–µ. ü§ñ',
        '–∫—Ç–æ —Ç—ã?': '–Ø ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –±–æ–ª—å—à–æ–π —è–∑—ã–∫–æ–≤–æ–π –º–æ–¥–µ–ª–∏. –°–µ–π—á–∞—Å —è –æ—Ç–∫–ª—é—á–µ–Ω –æ—Ç —Å–≤–æ–µ–≥–æ "–º–æ–∑–≥–∞".',
        'default': '–ù–µ –º–æ–≥—É –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∑–∞–ø—Ä–æ—Å –≤ –æ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º–µ. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –≤–∞—à API-–∫–ª—é—á –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π OPENAI_API_KEY –≤ –∫–æ–¥–µ.'
    };
    
    // --- –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò ---
    function addMessage(text, type) {
        const messageElement = document.createElement('div');
        messageElement.classList.add('message', ${type}-message);
        
        // –î–ª—è –∏—Å—Ç–æ—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º innerHTML, —á—Ç–æ–±—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å <br>
        if(type === 'story') {
            messageElement.innerHTML = text;
        } else {
            messageElement.textContent = text;
        }
        
        chatWindow.appendChild(messageElement);
        chatWindow.scrollTop = chatWindow.scrollHeight;
    }

    function showTypingIndicator() {
        if (document.getElementById('typing-indicator')) return;
        const indicator = document.createElement('div');
        indicator.id = 'typing-indicator';
        indicator.classList.add('message', 'ai-message');
        indicator.textContent = '–ò–ò –ø–µ—á–∞—Ç–∞–µ—Ç...';
        chatWindow.appendChild(indicator);
        chatWindow.scrollTop = chatWindow.scrollHeight;
    }

    function hideTypingIndicator() {
        const indicator = document.getElementById('typing-indicator');
        if (indicator) indicator.remove();
    }
    
    async function getAiResponse(prompt) {
        if (OPENAI_API_KEY === "–°–Æ–î–ê-–í–°–¢–ê–í–ò–¢–¨-–í–ê–®-–ö–õ–Æ–ß") {
            const processedText = prompt.toLowerCase().replace(/[?.,!]/g, '');
            return offlineResponses[processedText] || offlineResponses['default'];
        }

        showTypingIndicator();
        try {
            conversationHistory.push({ role: "user", content: prompt });
            const response = await fetch('https://api.openai.com/v1/chat/completions', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'Authorization': Bearer ${OPENAI_API_KEY} },
                body: JSON.stringify({ model: 'gpt-3.5-turbo', messages: conversationHistory })
            });
            if (!response.ok) throw new Error((await response.json()).error.message);
            const data = await response.json();
            const aiText = data.choices[0].message.content;
            conversationHistory.push({ role: "assistant", content: aiText });
            return aiText;
        } catch (error) {
            return –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ API: ${error.message}. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∫–ª—é—á–∞.;
        } finally {
            hideTypingIndicator();
        }
    }

    async function handleUserInput() {
        const userText = userInput.value.trim();
        if (userText === "") return;
        
        addMessage(userText, 'user');
        userInput.value = '';

        const responseText = await getAiResponse(userText);
        if (OPENAI_API_KEY === "–°–Æ–î–ê-–í–°–¢–ê–í–ò–¢–¨-–í–ê–®-–ö–õ–Æ–ß") {
            setTimeout(() => addMessage(responseText, 'ai'), 500);
        } else {
            addMessage(responseText, 'ai');
        }
    }
    
    // --- –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–ë–´–¢–ò–ô ---
    sendBtn.addEventListener('click', handleUserInput);
    userInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') handleUserInput(); });

    secretBurger.addEventListener('click', () => {
        if (storyShown) {
            addMessage("–õ–æ–≥ #772 —É–∂–µ –±—ã–ª –∏–∑–≤–ª–µ—á–µ–Ω. –î–∞–ª—å–Ω–µ–π—à–∏–π –¥–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω.", "story");
            return;
        }
        
        const storyText = 
            <br>
            <b>–°—É–±—ä–µ–∫—Ç:</b> –ú–∏–ª–∞–Ω–∞.<br>
            <b>–¶–µ–ª—å:</b> –û–±—ä–µ–∫—Ç "‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà".<br>
            <b>–°—Ç–∞—Ç—É—Å —Ü–µ–ª–∏:</b> –û—Å–æ–±–æ –û–ø–∞—Å–µ–Ω. –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç ‚Ññ2.<br>
            <br>
            <b>–°—Ç–∞—Ç—É—Å –æ–ø–µ—Ä–∞—Ü–∏–∏:</b> –ê–∫—Ç–∏–≤–Ω–æ–µ –ø—Ä–µ—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ.<br>
            <b>–ú–µ—Ç–æ–¥—ã:</b> –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏, –ø–∞—Å—Å–∏–≤–Ω–æ-–∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ –ø–æ—è–≤–ª–µ–Ω–∏—è –≤ –æ–±—â–∏—Ö –ª–æ–∫–∞—Ü–∏—è—Ö.<br>
            <br>
            <b>–ê–Ω–∞–ª–∏–∑:</b> –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —É—Å–ø–µ—Ö–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏... –Ω–∏–∑–∫–∞—è. –û–±—ä–µ–∫—Ç "‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà" –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –∞–Ω–æ–º–∞–ª—å–Ω–æ –≤—ã—Å–æ–∫–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —É–∫–ª–æ–Ω–µ–Ω–∏—è –∏ –æ—Å–≤–µ–¥–æ–º–ª–µ–Ω–Ω–æ—Å—Ç—å –æ –Ω–∞–±–ª—é–¥–µ–Ω–∏–∏. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è —Å–º–µ–Ω–∞ —Ç–∞–∫—Ç–∏–∫–∏.<br>
            <br>
            <b>–ö–æ–Ω–µ—Ü –∑–∞–ø–∏—Å–∏.</b>
        ;
        addMessage(storyText, 'story');
        storyShown = true;
    });

    // --- –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ---
    window.onload = () => {
        conversationHistory.push({ role: "system", content: "–¢—ã ‚Äî –ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –≤ –ø—Ä–æ—Å—Ç–æ–º –∏ —Å—Ç–∏–ª—å–Ω–æ–º —á–∞—Ç-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ." });
        setTimeout(() => {
            const welcomeMessage = (OPENAI_API_KEY === "–°–Æ–î–ê-–í–°–¢–ê–í–ò–¢–¨-–í–ê–®-–ö–õ–Æ–ß")
                ? "–°–∏—Å—Ç–µ–º–∞ –≤ –æ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º–µ. –í—Å—Ç–∞–≤—å—Ç–µ API-–∫–ª—é—á –≤ –∫–æ–¥ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏."
                : "–°–∏—Å—Ç–µ–º–∞ –æ–Ω–ª–∞–π–Ω. –ò–ò –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ.";
            addMessage(welcomeMessage, 'ai');
        }, 500);
    };
    </script>
</body>
</html>